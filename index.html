<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>橘子小镇论坛</title>
<style>
    body{ margin:0; font-family:-apple-system,BlinkMacSystemFont,Tahoma,Arial; background-image:url("orange.png"); background-repeat:repeat; background-size:120px; background-color: #fdf6ec; }
    .phone{ max-width:420px; margin:20px auto; background:#fffdf8; border-radius:18px; box-shadow:0 8px 30px rgba(0,0,0,0.08); overflow:hidden; min-height: 90vh; }
    .topbar{ background:#c58f5c; color:white; padding:12px; font-size:15px; text-align:center; position:relative; }
    .thread-title{ padding:14px; font-size:15px; font-weight:bold; background:#f6efe5; border-bottom:1px solid #eee3d4; color: #5a4a3a; }
    
    /* 楼层样式 */
    .post{ padding:15px; border-bottom:1px solid #f3eadf; }
    .username{ font-size:13px; font-weight:bold; color: #4a3c2e; margin-bottom:4px; }
    .floor-info{ font-size:11px; color:#9c8b7d; margin-bottom:10px; }

    /* --- 核心：仿真实论坛的引用样式 --- */
    .bbs-quote {
        background: #f1e9db;
        border: 1px solid #e2d2ba;
        padding: 10px;
        margin: 5px 0 15px 0;
        font-size: 12px;
        color: #666;
        border-radius: 4px;
    }
    .quote-header {
        border-bottom: 1px dashed #d1c1a9; /* 经典的虚线分割 */
        margin-bottom: 8px;
        padding-bottom: 4px;
        color: #a05d2c;
        font-weight: bold;
    }
    .quote-content {
        line-height: 1.5;
        font-style: italic;
    }

    .content{ font-size:14.5px; line-height:1.7; color: #333; white-space: pre-wrap; }
    .pagebar{ padding:15px; text-align:center; font-size:13px; background:#faf6ef; color: #a05d2c; cursor: pointer; }
</style>
</head>
<body>

<div class="phone">
    <div class="topbar">橘子小镇论坛</div>
    <div class="thread-title">「「求助」我的狗总是对邻居的狗进行骑跨行为，对方主人每次都吓得尖叫，我该怎么道歉？</div>
    
    <div id="posts"></div>
    <div class="pagebar" onclick="nextPage()">点击翻页 / 继续阅读故事</div>
</div>

<script>
let currentPage = 1;
const OP_NAME = "我家狗狗可爱";
let allPostsData = {}; 

function renderPosts(){
    const container = document.getElementById("posts");
    container.innerHTML = "";
    const pageData = allPostsData[currentPage] || [];
    
    let globalOffset = 0;
    for(let i = 1; i < currentPage; i++) {
        if(allPostsData[i]) globalOffset += allPostsData[i].length;
    }

    pageData.forEach((p, index) => {
        const floor = globalOffset + index + 1;

        // --- 新增：仿论坛引用渲染逻辑 ---
        let quoteHTML = "";
        if (p.quoteUser && p.quoteContent) {
            quoteHTML = `
                <div class="bbs-quote">
                    <div class="quote-header">引用 ${p.quoteFloor || '?'} 楼 @${p.quoteUser} 的发言:</div>
                    <div class="quote-content">${p.quoteContent}</div>
                </div>`;
        }

        const postDiv = document.createElement("div");
        postDiv.className = "post";
        postDiv.innerHTML = `
            <div class="username">${p.name} ${p.name===OP_NAME ? '<span style="color:#c58f5c;font-size:11px;">[楼主]</span>' : ''}</div>
            <div class="floor-info">${floor}楼 ｜ 发表于 ${p.time}</div>
            ${quoteHTML}
            <div class="content">${p.content}</div>
        `;
        container.appendChild(postDiv);
    });
}

function render(data, page){
    allPostsData[page] = data;
    renderPosts();
}

function loadPage(page){
    currentPage = page;
    const script = document.createElement("script");
    script.src = `page${page}.js?v=${Date.now()}`;
    document.body.appendChild(script);
}

function nextPage() {
    currentPage++;
    loadPage(currentPage);
}

loadPage(1);
</script>
</body>
</html>
